{% extends "admin/base_admin.html" %}
{% block title %}Chunks - Admin Dashboard{% endblock %}
{% block content %}
<div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
<div class="px-6 py-4 border-b border-gray-100 bg-gray-50 flex justify-between items-center"><div><h2 class="text-lg font-semibold text-gray-800">Knowledge Chunks</h2><p class="text-xs text-gray-500">Showing last 100 chunks</p></div><button onclick="loadChunks()" class="p-2 text-gray-500 hover:text-blue-600 transition rounded-full hover:bg-blue-50"><i class="fas fa-sync-alt"></i></button></div>
<div class="overflow-x-auto">
<table class="min-w-full divide-y divide-gray-200">
<thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider w-20">ID</th><th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider w-48">Document</th><th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Content Preview</th><th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider w-24">Index</th></tr></thead>
<tbody id="chunk-list" class="bg-white divide-y divide-gray-200"></tbody>
</table>
<div id="empty-state" class="hidden py-12 text-center"><i class="fas fa-layer-group text-4xl text-gray-300 mb-3"></i><p class="text-gray-500">No chunks found.</p></div>
</div>
</div>
{% endblock %}
{% block scripts %}
<script>
async function loadChunks(){const tbody=document.getElementById('chunk-list');const emptyState=document.getElementById('empty-state');tbody.innerHTML='<tr><td colspan="4" class="px-6 py-4 text-center text-gray-500">Loading...</td></tr>';try{const res=await fetch('/api/admin/chunks');const data=await res.json();tbody.innerHTML='';if(data.length===0){emptyState.classList.remove('hidden');}else{emptyState.classList.add('hidden');data.forEach(chunk=>{const tr=document.createElement('tr');tr.innerHTML=`<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">#${chunk.id}</td><td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${chunk.document_filename}</td><td class="px-6 py-4 text-sm text-gray-600"><div class="truncate max-w-xl" title="${chunk.full_text}">${chunk.chunk_text}</div></td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${chunk.chunk_index}</td>`;tbody.appendChild(tr);});}}catch(e){tbody.innerHTML='<tr><td colspan="4" class="px-6 py-4 text-center text-red-500">Error loading chunks</td></tr>';}}
loadChunks();
</script>
{% endblock %}
